version: "3"
services:
  airflow:
    build: 
      context: ./
      dockerfile: Dockerfile.airflow

    image: airflowimage
    container_name: gemstone_prediction
    ports:
      - "8080:8080"  # Airflow UI
      - "5050:5050"  # MLflow UI

    environment:
      - AWS_ACCESS_KEY_ID=AKIAUBLAMOMDQQWDM2NV
      - AWS_SECRET_ACCESS_KEY=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
      - AWS_DEFAULT_REGION=ap-south-1
   
  flaskapp:
    build: 
      context: ./
      dockerfile: Dockerfile.flask

    image: flaskappimage
    container_name: gemstone_prediction_app
    ports:
      - "5000:5000"  # Flask app

    environment:
      - AWS_ACCESS_KEY_ID=AKIAUBLAMOMDQQWDM2NV
      - AWS_SECRET_ACCESS_KEY=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
      - AWS_DEFAULT_REGION=ap-south-1